<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="PHOTOSWAP-2: Personalized Subject Swapping via Appearance Adaptation">
  <meta name="keywords" content="Object Swapping, Personalized Editing">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>PHOTOSWAP-2: Personalized Subject Swapping via Appearance Adaptation</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="icon" href="./static/images/icon.png">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">PHOTOSWAP: Personalized Subject Swapping in Images</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://g-jing.github.io">Jing Gu</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://yilinwang.org/">Yilin Wang</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="http://nxzhao.com/">Nanxuan Zhao</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://wxiong.me/">Wei Xiong</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://qliu24.github.io/">Qing Liu</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://zzutk.github.io/">Zhifei Zhang</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://sites.google.com/site/hezhangsprinter/">He Zhang</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://cs-people.bu.edu/jmzhang/">Jianming Zhang</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://polaris79.wixsite.com/hjung">HyunJoon Jung</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://eric-xw.github.io/">Xin Eric Wang</a><sup>1</sup>,</span>
          </div>
          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>University of California, Santa Cruz,</span>
            <span class="author-block"><sup>2</sup>Adobe,</span>
          </div>
          
          <br>
          <div class="is-size-5 publication-authors">
            <span class="author-block"><b style="color:#e08ba0; font-weight:normal"> <b>Under Review</b> </b></span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://drive.google.com/file/d/1XNcGYdEtHit9sDJ3nUh_2rkbTvL51Kdz/view?usp=sharing"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img id="teaser" width="150%" src="./static/images/teaser-4.png?03222242">
      <h2 class="subtitle has-text-centered">
        <p style="font-family:Times New Roman"><b>Figure 1. Compared with Photoswap, Photoswap-2 is adept at conducting precise subject replacement within a source image by integrating a personalized subject from reference images, all the while maintaining the integrity of the non-subject pixels. The model demonstrates proficiency in partial subject alterations with high fidelity. </b></p>
      </h2>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Effective editing of personal content holds a pivotal role in enabling individuals to express their creativity,
             weave captivating narratives within their visual stories, and elevate the overall quality and impact of their visual content. 
             In this paper, we introduce a novel method for swapping semantic content within personal imagery to generate photo realistic results.
              Specifically, our objective is to generate personalized images where the global texture appearance remains consistent with the source image, 
              while the subject's identity is seamlessly swapped with user-defined concepts. Unlike existing methods such as Photoswap,
               which transfers the subject without considering the source image's context, our work prioritizes the preservation of the source style during subject identity transfer.
                 We introduced a unified appearance adaptation approach, enabling precise control over subject target location, shape, and style during the image generation process.
                  Our location adaptation ensures background integrity and enhances editing involving multiple subjects,
                   while shape and content adaptations are crucial for maintaining identity fidelity.
                    Additionally, style adaptation addresses disparities in image style between the source and the generated image.  
                    To demonstrate the robustness and versatility of our proposed method, we substantiate our claims through a combination 
            of quantitative metrics and qualitative showcases, showing significant improvements over existing methods.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>



<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">
        <h2 class="title is-3"><img id="painting_icon" width="5%" src="https://cdn-icons-png.flaticon.com/512/5379/5379860.png"> Targetted swapping with mask via appearance adaptation </h2> 
      </div>
    </div>

        <div class="columns is-centered has-text-centered">
          <div class="column is-six-fifths">
            <!-- <div class="content has-text-justified">
              <ul>
                <li>Given several images of a new concept, the diffusion model first learns the concept and converts it into a token. </li>
                <li>The attention output and attention map in the source image generation process are stored as control source </li>
                <li>The stored intermediate variables would be transferred to the target image generation process</li>
              </ul>
            </div>         -->
            <img id="model" width="100%" src="./static/images/method.png">
            <h3 class="subtitle has-text-centered">
              <p style="font-family:Times New Roman"><b>Figure 2. Overview of Photoswap-2 on swapping a subject from a source image into a personalized concept to get the target image.
                 The personalized concept is first converted into textual space to be treated as concept appearance. 
                 Meanwhile, the source image is first inverted into initial noise to obtain  U-Net variables (including attention map, attention output, and latent representation), 
                 stored during the source image recovery process.
                 These informative variables together with the extracted mask would be used for the appearance adaptation into the target image generation process.</b></p>
            </h3>   


        </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">
        <h2 class="title is-3"><img id="painting_icon" width="5%" src="https://cdn-icons-png.flaticon.com/512/5379/5379860.png"> Human Subject Swapping </h2> 
      </div>
    </div>

        <div class="columns is-centered has-text-centered">
          <div class="column is-six-fifths">
            <!-- <div class="content has-text-justified">
              <ul>
                <li> With consistent steps, swapping the self-attention output provides superior control over the layout, including the subject's gestures and the background details.</li>
                <li> Excessive swapping could affect the subject's identity, as the new concept introduced through the text prompt might be overshadowed by the swapping of the attention output or attention map.  </li>
                <li> Replacing the attention map for an extensive number of steps can result in an image with significant noise, possibly due to a compatibility issue between the attention map and the v vector.</li>
              </ul>
            </div>         -->
            <img id="model" width="100%" src="./static/images/human-subject.png">
            <h3 class="subtitle has-text-centered">
              <p style="font-family:Times New Roman"><b>Figure 3. Results for human subject swapping. </b></p>
            </h3>   
        </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">
        <h2 class="title is-3"><img id="painting_icon" width="5%" src="https://cdn-icons-png.flaticon.com/512/5379/5379860.png"> Non-human Subject Swapping </h2> 
      </div>
    </div>

        <div class="columns is-centered has-text-centered">
          <div class="column is-six-fifths">
            <!-- <div class="content has-text-justified">
              <ul>
                <li> With consistent steps, swapping the self-attention output provides superior control over the layout, including the subject's gestures and the background details.</li>
                <li> Excessive swapping could affect the subject's identity, as the new concept introduced through the text prompt might be overshadowed by the swapping of the attention output or attention map.  </li>
                <li> Replacing the attention map for an extensive number of steps can result in an image with significant noise, possibly due to a compatibility issue between the attention map and the v vector.</li>
              </ul>
            </div>         -->
            <img id="model" width="100%" src="./static/images/non-human-subject.png">
            <h3 class="subtitle has-text-centered">
              <p style="font-family:Times New Roman"><b>Figure 3. Results for non-human subject swapping. </b></p>
            </h3>   
        </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">
        <h2 class="title is-3"><img id="painting_icon" width="5%" src="https://cdn-icons-png.flaticon.com/512/5379/5379860.png"> Robustness Demonstration. </h2> 
      </div>
    </div>

        <div class="columns is-centered has-text-centered">
          <div class="column is-six-fifths">
            <!-- <div class="content has-text-justified">
              <ul>
                <li> With consistent steps, swapping the self-attention output provides superior control over the layout, including the subject's gestures and the background details.</li>
                <li> Excessive swapping could affect the subject's identity, as the new concept introduced through the text prompt might be overshadowed by the swapping of the attention output or attention map.  </li>
                <li> Replacing the attention map for an extensive number of steps can result in an image with significant noise, possibly due to a compatibility issue between the attention map and the v vector.</li>
              </ul>
            </div>         -->
            <img id="model" width="100%" src="./static/images/robustness.png">
            <h3 class="subtitle has-text-centered">
              <p style="font-family:Times New Roman"><b>Figure 3. Photoswap-2 results on cross-domain image subject
                swap. With a variety of source images, including graphic, blackwhite photos, and oil paintings, the framework seamlessly integrates concept subjects taken from regular internet images into
                these diverse source images. </b></p>
            </h3>   
        </div>
  </div>
</section>

<!-- <section class="section"   style="background-color:#e4e4f781">
  <div class="columns is-centered has-text-centered">
      <div style="width:90%;">

        <div style="float:left; width:47.1%; border: 0px solid black;">
          <h2 class="title is-5">I. Multi-subject swap</h2>
          <div class="content has-text-justified">
            Photoswap can disentangle and replace multiple subjects at once.                 
          </div>  

          <div class="column is-five-fifths">
              <div class="columns is-centered">
                <img id="modulated_training" width="105%" src="./static/images/multiple-subjects.png">
                
              </div>
          </div>
        </div>


        <div style=" float:right; width:47.8%; border: 0px solid black;">
          <h2 class="title is-5">II. Occluded subject swap</h2>
          <div class="content has-text-justified">
            Photoswap can identify the target object while avoiding influencing the non-subject pixels                  
          </div>  

          <div class="column is-five-fifths">
              <div class="columns is-centered">
                <img id="modulated_training" width="97%" src="./static/images/occluded.png">
                
              </div>
          </div>
        </div>

      </div>  
    </div>     
</section> -->

<!-- 
<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">
        <h2 class="title is-3"><img id="painting_icon" width="5%" src="https://cdn-icons-png.flaticon.com/512/5379/5379860.png"> More Results </h2> 
      </div>
    </div>
        <div class="columns is-centered has-text-centered">
          <div class="column is-six-fifths">
            <div class="content has-text-justified">
              <p>
                From everyday objects to cartoon, the diversity in subject swapping tasks has showcased
                the versatility and robustness of our framework across different contexts.
              </p>
            </div>        
            <img id="model" width="100%" src="./static/images/more-results.png">
            <h3 class="subtitle has-text-centered">
              <p style="font-family:Times New Roman"><b>Figure 4. More results at various domains. </b></p>
            </h3>   
        </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">
        <h2 class="title is-3"><img id="painting_icon" width="5%" src="https://cdn-icons-png.flaticon.com/512/5379/5379860.png"> Qualitative Comparison</h2> 
      </div>
    </div>
        <div class="columns is-centered has-text-centered">
          <div class="column is-six-fifths">
            <div class="content has-text-justified">
              <p>
                We set P2P+DreamBooth as a baseline for Photoswap. The former faces challenges in 
                preserving both the background and the reference subject accurately, while for Photoswap, it is robust to handle various cases.
              </p>
            </div>        
            <img id="model" width="100%" src="./static/images/p2p-compare.png">
            <h3 class="subtitle has-text-centered">
              <p style="font-family:Times New Roman"><b>Figure 5. Comparison with P2P+DreamBooth. </b></p>
            </h3>   
        </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">
        <h2 class="title is-3"><img id="painting_icon" width="5%" src="https://cdn-icons-png.flaticon.com/512/5379/5379860.png"> Similarity Control </h2> 
      </div>
    </div>
        <div class="columns is-centered has-text-centered">
          <div class="column is-six-fifths">
            <div class="content has-text-justified">
              <p>
                With proper parameters, we could control the similarity between the generated image and the source image.
              </p>
            </div>        
            <img id="model" width="100%" src="./static/images/identity-control.png">
            <h3 class="subtitle has-text-centered">
              <p style="font-family:Times New Roman"><b>Figure 6. Control over similarity. </b></p>
            </h3>   
        </div>
  </div>
</section>
 -->

<!-- 
<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@misc{gu2023photoswap,
      title={Photoswap: Personalized Subject Swapping in Images}, 
      author={Jing Gu and Yilin Wang and Nanxuan Zhao and Tsu-Jui Fu and Wei Xiong and Qing Liu and Zhifei Zhang and He Zhang and Jianming Zhang and HyunJoon Jung and Xin Eric Wang},
      year={2023},
      eprint={2305.18286},
      archivePrefix={arXiv},
      primaryClass={cs.CV}
}</code></pre>
  </div>
</section> -->


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is adapted from <a rel="license"
            href="https://github.com/nerfies/nerfies.github.io">Nerfies</a> and <a rel="license"
            href="https://gligen.github.io/">GLIGEN</a>, licensed under a Creative Commons Attribution-ShareAlike 4.0 International License.
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
